---
title: "p8105_hw2_yy3563.Rmd"
author: "Yifei Yu"
date: "2024-10-01"
output: github_document
---

```{r}
library(tidyverse)
library(dplyr)
library(readxl)
library(haven)
```


## Problem 1

```{r}
nyc_transit = 
  read_csv("Homework2_data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
           na = c("NA", "", ".")) |> 
  janitor::clean_names() |> 
  select(line, station_name, station_latitude, station_longitude, starts_with("route"), entry, vending, entrance_type, ada) |> 
  mutate(entry = if_else(entry == "YES", 1, 0))
```

The dataset `nyc_transit` contains `line`, `station_name`, `station_latitude`, `entry`, `vending`, `entrance_type`, `ada`, and all the routes served.

One variable named `entry`, originally contained the values "YES" and "NO" to indicate whether an entrance allows entry, which has been changed into numeric values where "YES" is replaced with 1 and "NO" is replaced with 0.

The cleaning steps so far include renaming the variables name, making them into lowercase with underscores instead of space and only retain those useful variables for analysis and exclude other variables.

The dimension of the resulting dataset includes 1868 rows and 32 columns.

The data are tidy because columns are variables and observations are on the row. 

### Answering three questions

```{r}
nrow(distinct(nyc_transit, station_name, line))
```

There are 465 distinct stations.

```{r}
ada_compliant = nyc_transit |> 
  filter(ada == "TRUE") |> 
  distinct(station_name, line) |> 
  nrow()
```

84 stations are ADA compliant.

```{r}
proportion = nyc_transit |> 
  filter(entry == 1) |> 
  summarise(proportion = mean(vending == "NO"))
```

The proportion of station entrances / exits without vending allow entrance is 0.0394.

### Reformat data so that route number and route name are distinct variables.

```{r}
nyc_transit = nyc_transit |> 
  mutate(across(starts_with("route"), as.character))

nyc_transit_new = nyc_transit |> 
  pivot_longer(cols = starts_with("route"),
               names_to = "route_number",
               values_to = "route_name")
```

```{r}
station_serving_A = nyc_transit_new |> 
  filter(route_name == "A") |> 
  distinct(station_name, line) |> 
  nrow()
```

There are 60 distinct stations serve the A train.

```{r}
ada_station_serving_A = nyc_transit_new |> 
  filter(route_name == "A", ada == "TRUE") |> 
  distinct(station_name, line) |> 
  nrow()
```

Of the stations that serve the A train, 17 of them are ADA compliant.

## Problem 2

```{r}
mr_trash_wheel = 
  read_excel("Homework2_data/202409 Trash Wheel Collection Data.xlsx", 
             sheet = "Mr. Trash Wheel", range = "A2:N653") |> 
  janitor::clean_names() |> 
  mutate(sports_balls = as.integer(round(sports_balls)))
```

```{r}
professor_trash_wheel = 
  read_excel("Homework2_data/202409 Trash Wheel Collection Data.xlsx", 
             sheet = "Professor Trash Wheel", range = "A2:M120") |> 
  janitor::clean_names()
```

```{r}
gwynnda_trash_wheel = 
  read_excel("Homework2_data/202409 Trash Wheel Collection Data.xlsx", 
             sheet = "Gwynnda Trash Wheel", range = "A2:L265") |> 
  janitor::clean_names()
```



